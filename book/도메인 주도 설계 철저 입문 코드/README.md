# 도메인 주도 설계 철저 입문 - 코드와 패턴으로 밑바닥부터 이해하는 DDD

## 02. 시스템 특유의 값을 나타내기 위한 '값 객체'
- 정의
    - 시스템 고유의 값을 나타내는 객체
- 값의 성질
    - 변하지 않는다.
    - 수정할 수는 없고 대입할 수는 있다.
    - 값의 속성을 꺼내 비교하는 것이 아니라 값끼리 비교한다.
- 값 객체가 되기 위한 기준(필자 개인적인 기준) # 이 부분이 잘 이해가 안 가네.
    - 규칙이 존재하는 경우
    - 낱개로 다루어야 하는 경우
- 특징
  - 행동을 가진다.
- 장점
  - 표현력이 증가한다.
    - 규칙을 값 객체 내부에 정의함으로써 코드 자체가 문서화 역할을 할 수 있다.
  - 무결성이 유지된다.
    - 예를 들어, 유효성 검사를 값 객체를 호출하는 곳에서 알아서 체크하도록 둔다면 중복된 코드가 곳곳에 흩어진다. 또한, 유효성 검사를 잘못 했을 경우 잠재적인 버그가 생길 수 있다.
  - 잘못된 대입을 방지한다.
  - 로직이 곳곳이 흩어지는 것을 방지한다.

## 03. 생애주기를 갖는 객체 - 엔티티 
- 정의
  - 도메인 모델을 구현한 도메인 객체
- 성질
  - 가변이다.
    - 엔티티의 속성은 객체의 행동을 통해 수정한다.
  - 속성이 같아도 식별자(identity)로 구분한다.
  - 동일성을 통해 구별된다.
    - equals, hashCode를 통해 비교한다.
- 값 객체 vs 엔티티 구별 판단 기준
  - 공통점
    - 모두 도메인 모델을 구현한 도메인 객체
  - 차이점
    - 엔티티: 속성과 무관한 동일성(identity)로 식별한다. 생애주기를 갖고 있다.
    - 값 객체: 변하지 않는 속성과 값으로 식별한다. 생애주기를 갖지 않거나 생애주기를 나타내는 것이 무의미하다.
- 장점
  - 자기 서술적인 코드가 된다.
  - 도메인에 변경사항이 있을 시 코드에 반영하기 쉽다.
- 특이사항
  - 같은 대상이더라도 어떤 환경에 있느냐에 따라 모델링 방법이 달라진다. 따라서, 어떤 경우에는 값 객체가 적당할 수도 있고, 어떤 경우에는 엔티티가 적당할 수도 있다.

## 04. 부자연스러움을 해결하는 도메인 서비스
- 서비스 종류
  - 도메인 서비스
  - 애플리케이션 서비스
- 도메인 서비스 정의
  - 값 객체나 엔티티로 구현하기 어색한 행위를 해결해주는 객체이다.
- 장점
  - 도메인에 정의하면 어색한 행위를 떼어내어 부자연스러움을 해결해 준다.
- 주의점
  - 도메인 객체에 정의할 행위까지 도메인 서비스에 정의하면 getter, setter만 남는 빈혈 도메인 객체가 된다. 이는 데이터와 행위를 함께 모아 놓는다는 객체지향 설계의 기본 원칙을 위반한다.
  - 도메인 객체를 통해 해당 도메인을 이해하기 어렵다.
  - 따라서, 값 객체나 엔티티로 구현할지 도메인 서비스로 정의할 지 헷갈리면 우선 값 객체나 엔티티로 정의한다.
- 유스케이스 수립하여 도메인 서비스 이해하기

## 05. 데이터와 관계된 처리를 분리하자 - 리포지토리
- 정의
  - 데이터를 저장하고 복원하는 처리를 추상화한 객체이다.
- 책임
  - 도메인 객체를 저장하고 복원하는 퍼시스턴시이다.
  - 도메인 개념으로부터 유래한 객체가 아니다. 데이터스토어를 조작하는 기술적 요소와 관련된 코드를 모아 문제를 해결하여 도메인 객체에서 코드를 분리시킨다.
- 테스트로 검증을 구현한다.
- ORM Framework에서 사용하는 객체(데이터 모델)은 도메인 엔티티와 전혀 다른 것이다.
